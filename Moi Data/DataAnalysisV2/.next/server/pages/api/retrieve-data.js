"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/retrieve-data";
exports.ids = ["pages/api/retrieve-data"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "papaparse":
/*!****************************!*\
  !*** external "papaparse" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("papaparse");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fretrieve-data&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fretrieve-data.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fretrieve-data&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fretrieve-data.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_retrieve_data_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/retrieve-data.js */ \"(api)/./pages/api/retrieve-data.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_retrieve_data_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_retrieve_data_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/retrieve-data\",\n        pathname: \"/api/retrieve-data\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_retrieve_data_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnJldHJpZXZlLWRhdGEmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyUyRmFwaSUyRnJldHJpZXZlLWRhdGEuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDeUQ7QUFDekQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHdEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyx3REFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tb2ktdXBsb2FkLXN5c3RlbS8/ZDBlNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL3JldHJpZXZlLWRhdGEuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9yZXRyaWV2ZS1kYXRhXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcmV0cmlldmUtZGF0YVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fretrieve-data&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fretrieve-data.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/supabase.ts":
/*!*************************!*\
  !*** ./lib/supabase.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TABLE_NAMES: () => (/* binding */ TABLE_NAMES),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   uploadCSVToSupabase: () => (/* binding */ uploadCSVToSupabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\nconst supabaseUrl = \"https://nbclorobfotxrpbmyapi.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5iY2xvcm9iZm90eHJwYm15YXBpIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2MTc5NTczMiwiZXhwIjoyMDc3MzcxNzMyfQ.xXIzeKJFq5qFfQYcuY-OMAixpM7mph4hTzFnbcX2btg\";\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\nconst TABLE_NAMES = {\n    meta: \"meta_import_data\",\n    google: \"google_import_data\",\n    shopify: \"shopify_import_data\"\n};\nasync function uploadCSVToSupabase(platform, file) {\n    try {\n        const text = await file.text();\n        const Papa = (await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! papaparse */ \"papaparse\", 23))).default;\n        const { data: rows, errors } = Papa.parse(text, {\n            header: true,\n            skipEmptyLines: true,\n            transformHeader: (header)=>header.trim()\n        });\n        if (errors.length > 0) {\n            return {\n                success: false,\n                message: `CSV parsing failed: ${errors[0].message}`,\n                insertedCount: 0\n            };\n        }\n        const tableName = TABLE_NAMES[platform];\n        // Transform rows for database insertion\n        const transformedRows = rows.map((row)=>{\n            const transformed = {};\n            // Platform-specific transformations - Map to EXACT database column names\n            if (platform === \"google\") {\n                transformed.Day = row.Day;\n                transformed.Campaign = row.Campaign;\n                transformed[\"Currency code\"] = row[\"Currency code\"] || \"INR\";\n                transformed.Cost = parseFloat(row.Cost) || 0;\n                transformed[\"Avg. CPM\"] = parseFloat(row[\"Avg. CPM\"]) || 0;\n                transformed.CTR = parseFloat(row.CTR?.replace(\"%\", \"\")) || 0;\n            } else if (platform === \"meta\") {\n                transformed[\"Campaign name\"] = row[\"Campaign name\"];\n                transformed[\"Ad set name\"] = row[\"Ad set name\"];\n                transformed[\"Ad name\"] = row[\"Ad name\"];\n                transformed.Day = row.Day;\n                transformed[\"Amount spent (INR)\"] = parseFloat(row[\"Amount spent (INR)\"]) || 0;\n                transformed[\"CPM (cost per 1,000 impressions)\"] = parseFloat(row[\"CPM (cost per 1,000 impressions)\"]) || 0;\n                transformed[\"CTR (link click-through rate)\"] = parseFloat(row[\"CTR (link click-through rate)\"]?.replace(\"%\", \"\")) || 0;\n            } else if (platform === \"shopify\") {\n                transformed.Day = row.Day;\n                transformed[\"UTM campaign\"] = row[\"UTM campaign\"];\n                transformed[\"UTM term\"] = row[\"UTM term\"];\n                transformed[\"UTM content\"] = row[\"UTM content\"];\n                transformed[\"Landing page URL\"] = row[\"Landing page URL\"];\n                transformed[\"Online store visitors\"] = parseInt(row[\"Online store visitors\"]) || 0;\n                transformed[\"Sessions that completed checkout\"] = parseInt(row[\"Sessions that completed checkout\"]) || 0;\n                transformed[\"Sessions that reached checkout\"] = parseInt(row[\"Sessions that reached checkout\"]) || 0;\n                transformed[\"Sessions with cart additions\"] = parseInt(row[\"Sessions with cart additions\"]) || 0;\n                transformed[\"Average session duration\"] = parseFloat(row[\"Average session duration\"]) || 0;\n                transformed.Pageviews = parseInt(row.Pageviews) || 0;\n            }\n            return transformed;\n        });\n        // Insert data in batches\n        const BATCH_SIZE = 500;\n        let insertedCount = 0;\n        for(let i = 0; i < transformedRows.length; i += BATCH_SIZE){\n            const batch = transformedRows.slice(i, i + BATCH_SIZE);\n            const { data, error } = await supabase.from(tableName).insert(batch).select();\n            if (error) {\n                console.error(`Batch insert error:`, error);\n                return {\n                    success: false,\n                    message: `Database insert failed: ${error.message}`,\n                    insertedCount\n                };\n            }\n            insertedCount += batch.length;\n        }\n        return {\n            success: true,\n            message: `Successfully uploaded ${insertedCount} rows`,\n            insertedCount,\n            data: transformedRows\n        };\n    } catch (error) {\n        console.error(\"Upload error:\", error);\n        return {\n            success: false,\n            message: `Upload failed: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n            insertedCount: 0\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVM7WUFDVEMsU0FBUyxDQUFDLGVBQWUsRUFBRW1CLGlCQUFpQkssUUFBUUwsTUFBTW5CLE9BQU8sR0FBRyxnQkFBZ0IsQ0FBQztZQUNyRkMsZUFBZTtRQUNqQjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tb2ktdXBsb2FkLXN5c3RlbS8uL2xpYi9zdXBhYmFzZS50cz9jOTlmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcblxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhXG5jb25zdCBzdXBhYmFzZUFub25LZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSFcblxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXkpXG5cbmV4cG9ydCB0eXBlIFBsYXRmb3JtID0gJ21ldGEnIHwgJ2dvb2dsZScgfCAnc2hvcGlmeSdcblxuZXhwb3J0IGNvbnN0IFRBQkxFX05BTUVTOiBSZWNvcmQ8UGxhdGZvcm0sIHN0cmluZz4gPSB7XG4gIG1ldGE6ICdtZXRhX2ltcG9ydF9kYXRhJyxcbiAgZ29vZ2xlOiAnZ29vZ2xlX2ltcG9ydF9kYXRhJywgXG4gIHNob3BpZnk6ICdzaG9waWZ5X2ltcG9ydF9kYXRhJ1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBsb2FkQ1NWVG9TdXBhYmFzZShwbGF0Zm9ybTogUGxhdGZvcm0sIGZpbGU6IEZpbGUpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgZmlsZS50ZXh0KClcbiAgICBjb25zdCBQYXBhID0gKGF3YWl0IGltcG9ydCgncGFwYXBhcnNlJykpLmRlZmF1bHRcbiAgICBcbiAgICBjb25zdCB7IGRhdGE6IHJvd3MsIGVycm9ycyB9ID0gUGFwYS5wYXJzZSh0ZXh0LCB7XG4gICAgICBoZWFkZXI6IHRydWUsXG4gICAgICBza2lwRW1wdHlMaW5lczogdHJ1ZSxcbiAgICAgIHRyYW5zZm9ybUhlYWRlcjogKGhlYWRlcjogc3RyaW5nKSA9PiBoZWFkZXIudHJpbSgpXG4gICAgfSlcblxuICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6IGBDU1YgcGFyc2luZyBmYWlsZWQ6ICR7ZXJyb3JzWzBdLm1lc3NhZ2V9YCxcbiAgICAgICAgaW5zZXJ0ZWRDb3VudDogMFxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHRhYmxlTmFtZSA9IFRBQkxFX05BTUVTW3BsYXRmb3JtXVxuICAgIFxuICAgIC8vIFRyYW5zZm9ybSByb3dzIGZvciBkYXRhYmFzZSBpbnNlcnRpb25cbiAgICBjb25zdCB0cmFuc2Zvcm1lZFJvd3MgPSByb3dzLm1hcCgocm93OiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkOiBhbnkgPSB7fVxuICAgICAgXG4gICAgICAvLyBQbGF0Zm9ybS1zcGVjaWZpYyB0cmFuc2Zvcm1hdGlvbnMgLSBNYXAgdG8gRVhBQ1QgZGF0YWJhc2UgY29sdW1uIG5hbWVzXG4gICAgICBpZiAocGxhdGZvcm0gPT09ICdnb29nbGUnKSB7XG4gICAgICAgIHRyYW5zZm9ybWVkLkRheSA9IHJvdy5EYXlcbiAgICAgICAgdHJhbnNmb3JtZWQuQ2FtcGFpZ24gPSByb3cuQ2FtcGFpZ25cbiAgICAgICAgdHJhbnNmb3JtZWRbJ0N1cnJlbmN5IGNvZGUnXSA9IHJvd1snQ3VycmVuY3kgY29kZSddIHx8ICdJTlInXG4gICAgICAgIHRyYW5zZm9ybWVkLkNvc3QgPSBwYXJzZUZsb2F0KHJvdy5Db3N0KSB8fCAwXG4gICAgICAgIHRyYW5zZm9ybWVkWydBdmcuIENQTSddID0gcGFyc2VGbG9hdChyb3dbJ0F2Zy4gQ1BNJ10pIHx8IDBcbiAgICAgICAgdHJhbnNmb3JtZWQuQ1RSID0gcGFyc2VGbG9hdChyb3cuQ1RSPy5yZXBsYWNlKCclJywgJycpKSB8fCAwXG4gICAgICB9IGVsc2UgaWYgKHBsYXRmb3JtID09PSAnbWV0YScpIHtcbiAgICAgICAgdHJhbnNmb3JtZWRbJ0NhbXBhaWduIG5hbWUnXSA9IHJvd1snQ2FtcGFpZ24gbmFtZSddXG4gICAgICAgIHRyYW5zZm9ybWVkWydBZCBzZXQgbmFtZSddID0gcm93WydBZCBzZXQgbmFtZSddXG4gICAgICAgIHRyYW5zZm9ybWVkWydBZCBuYW1lJ10gPSByb3dbJ0FkIG5hbWUnXVxuICAgICAgICB0cmFuc2Zvcm1lZC5EYXkgPSByb3cuRGF5XG4gICAgICAgIHRyYW5zZm9ybWVkWydBbW91bnQgc3BlbnQgKElOUiknXSA9IHBhcnNlRmxvYXQocm93WydBbW91bnQgc3BlbnQgKElOUiknXSkgfHwgMFxuICAgICAgICB0cmFuc2Zvcm1lZFsnQ1BNIChjb3N0IHBlciAxLDAwMCBpbXByZXNzaW9ucyknXSA9IHBhcnNlRmxvYXQocm93WydDUE0gKGNvc3QgcGVyIDEsMDAwIGltcHJlc3Npb25zKSddKSB8fCAwXG4gICAgICAgIHRyYW5zZm9ybWVkWydDVFIgKGxpbmsgY2xpY2stdGhyb3VnaCByYXRlKSddID0gcGFyc2VGbG9hdChyb3dbJ0NUUiAobGluayBjbGljay10aHJvdWdoIHJhdGUpJ10/LnJlcGxhY2UoJyUnLCAnJykpIHx8IDBcbiAgICAgIH0gZWxzZSBpZiAocGxhdGZvcm0gPT09ICdzaG9waWZ5Jykge1xuICAgICAgICB0cmFuc2Zvcm1lZC5EYXkgPSByb3cuRGF5XG4gICAgICAgIHRyYW5zZm9ybWVkWydVVE0gY2FtcGFpZ24nXSA9IHJvd1snVVRNIGNhbXBhaWduJ11cbiAgICAgICAgdHJhbnNmb3JtZWRbJ1VUTSB0ZXJtJ10gPSByb3dbJ1VUTSB0ZXJtJ11cbiAgICAgICAgdHJhbnNmb3JtZWRbJ1VUTSBjb250ZW50J10gPSByb3dbJ1VUTSBjb250ZW50J11cbiAgICAgICAgdHJhbnNmb3JtZWRbJ0xhbmRpbmcgcGFnZSBVUkwnXSA9IHJvd1snTGFuZGluZyBwYWdlIFVSTCddXG4gICAgICAgIHRyYW5zZm9ybWVkWydPbmxpbmUgc3RvcmUgdmlzaXRvcnMnXSA9IHBhcnNlSW50KHJvd1snT25saW5lIHN0b3JlIHZpc2l0b3JzJ10pIHx8IDBcbiAgICAgICAgdHJhbnNmb3JtZWRbJ1Nlc3Npb25zIHRoYXQgY29tcGxldGVkIGNoZWNrb3V0J10gPSBwYXJzZUludChyb3dbJ1Nlc3Npb25zIHRoYXQgY29tcGxldGVkIGNoZWNrb3V0J10pIHx8IDBcbiAgICAgICAgdHJhbnNmb3JtZWRbJ1Nlc3Npb25zIHRoYXQgcmVhY2hlZCBjaGVja291dCddID0gcGFyc2VJbnQocm93WydTZXNzaW9ucyB0aGF0IHJlYWNoZWQgY2hlY2tvdXQnXSkgfHwgMFxuICAgICAgICB0cmFuc2Zvcm1lZFsnU2Vzc2lvbnMgd2l0aCBjYXJ0IGFkZGl0aW9ucyddID0gcGFyc2VJbnQocm93WydTZXNzaW9ucyB3aXRoIGNhcnQgYWRkaXRpb25zJ10pIHx8IDBcbiAgICAgICAgdHJhbnNmb3JtZWRbJ0F2ZXJhZ2Ugc2Vzc2lvbiBkdXJhdGlvbiddID0gcGFyc2VGbG9hdChyb3dbJ0F2ZXJhZ2Ugc2Vzc2lvbiBkdXJhdGlvbiddKSB8fCAwXG4gICAgICAgIHRyYW5zZm9ybWVkLlBhZ2V2aWV3cyA9IHBhcnNlSW50KHJvdy5QYWdldmlld3MpIHx8IDBcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkXG4gICAgfSlcblxuICAgIC8vIEluc2VydCBkYXRhIGluIGJhdGNoZXNcbiAgICBjb25zdCBCQVRDSF9TSVpFID0gNTAwXG4gICAgbGV0IGluc2VydGVkQ291bnQgPSAwXG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmFuc2Zvcm1lZFJvd3MubGVuZ3RoOyBpICs9IEJBVENIX1NJWkUpIHtcbiAgICAgIGNvbnN0IGJhdGNoID0gdHJhbnNmb3JtZWRSb3dzLnNsaWNlKGksIGkgKyBCQVRDSF9TSVpFKVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSh0YWJsZU5hbWUpXG4gICAgICAgIC5pbnNlcnQoYmF0Y2gpXG4gICAgICAgIC5zZWxlY3QoKVxuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgQmF0Y2ggaW5zZXJ0IGVycm9yOmAsIGVycm9yKVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIG1lc3NhZ2U6IGBEYXRhYmFzZSBpbnNlcnQgZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2V9YCxcbiAgICAgICAgICBpbnNlcnRlZENvdW50XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgaW5zZXJ0ZWRDb3VudCArPSBiYXRjaC5sZW5ndGhcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6IGBTdWNjZXNzZnVsbHkgdXBsb2FkZWQgJHtpbnNlcnRlZENvdW50fSByb3dzYCxcbiAgICAgIGluc2VydGVkQ291bnQsXG4gICAgICBkYXRhOiB0cmFuc2Zvcm1lZFJvd3NcbiAgICB9XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignVXBsb2FkIGVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6IGBVcGxvYWQgZmFpbGVkOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWAsXG4gICAgICBpbnNlcnRlZENvdW50OiAwXG4gICAgfVxuICB9XG59Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlQW5vbktleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwic3VwYWJhc2UiLCJUQUJMRV9OQU1FUyIsIm1ldGEiLCJnb29nbGUiLCJzaG9waWZ5IiwidXBsb2FkQ1NWVG9TdXBhYmFzZSIsInBsYXRmb3JtIiwiZmlsZSIsInRleHQiLCJQYXBhIiwiZGVmYXVsdCIsImRhdGEiLCJyb3dzIiwiZXJyb3JzIiwicGFyc2UiLCJoZWFkZXIiLCJza2lwRW1wdHlMaW5lcyIsInRyYW5zZm9ybUhlYWRlciIsInRyaW0iLCJsZW5ndGgiLCJzdWNjZXNzIiwibWVzc2FnZSIsImluc2VydGVkQ291bnQiLCJ0YWJsZU5hbWUiLCJ0cmFuc2Zvcm1lZFJvd3MiLCJtYXAiLCJyb3ciLCJ0cmFuc2Zvcm1lZCIsIkRheSIsIkNhbXBhaWduIiwiQ29zdCIsInBhcnNlRmxvYXQiLCJDVFIiLCJyZXBsYWNlIiwicGFyc2VJbnQiLCJQYWdldmlld3MiLCJCQVRDSF9TSVpFIiwiaSIsImJhdGNoIiwic2xpY2UiLCJlcnJvciIsImZyb20iLCJpbnNlcnQiLCJzZWxlY3QiLCJjb25zb2xlIiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/supabase.ts\n");

/***/ }),

/***/ "(api)/./pages/api/retrieve-data.js":
/*!************************************!*\
  !*** ./pages/api/retrieve-data.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/supabase */ \"(api)/./lib/supabase.ts\");\n\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const { startDate, endDate, reportType } = req.body;\n        if (!startDate || !endDate) {\n            return res.status(400).json({\n                error: \"Start date and end date are required\"\n            });\n        }\n        // Validate date format\n        const start = new Date(startDate);\n        const end = new Date(endDate);\n        if (isNaN(start.getTime()) || isNaN(end.getTime())) {\n            return res.status(400).json({\n                error: \"Invalid date format\"\n            });\n        }\n        if (start > end) {\n            return res.status(400).json({\n                error: \"Start date must be before end date\"\n            });\n        }\n        console.log(`Retrieving data from ${startDate} to ${endDate} for ${reportType} report`);\n        const results = [];\n        const data = {};\n        const localStorage = {};\n        // Platform configurations\n        const platforms = [\n            {\n                name: \"meta\",\n                table: \"meta_import_data\",\n                dateColumn: \"Day\"\n            },\n            {\n                name: \"google\",\n                table: \"google_import_data\",\n                dateColumn: \"Day\"\n            },\n            {\n                name: \"shopify\",\n                table: \"shopify_import_data\",\n                dateColumn: \"Day\"\n            }\n        ];\n        for (const platform of platforms){\n            try {\n                console.log(`Querying ${platform.table} for date range ${startDate} to ${endDate}`);\n                // Query Supabase for the platform data\n                const { data: platformData, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(platform.table).select(\"*\").gte(platform.dateColumn, startDate).lte(platform.dateColumn, endDate).order(platform.dateColumn, {\n                    ascending: true\n                });\n                if (error) {\n                    console.error(`Error querying ${platform.table}:`, error);\n                    results.push({\n                        platform: platform.name,\n                        success: false,\n                        rowCount: 0,\n                        dateRange: {\n                            min: null,\n                            max: null\n                        },\n                        error: error.message\n                    });\n                    data[platform.name] = null;\n                    continue;\n                }\n                const rowCount = platformData ? platformData.length : 0;\n                // Get date range from actual data\n                let dateRangeActual = {\n                    min: null,\n                    max: null\n                };\n                if (rowCount > 0) {\n                    const dates = platformData.map((row)=>row[platform.dateColumn]).filter(Boolean);\n                    if (dates.length > 0) {\n                        const sortedDates = dates.sort();\n                        dateRangeActual = {\n                            min: sortedDates[0],\n                            max: sortedDates[sortedDates.length - 1]\n                        };\n                    }\n                }\n                // Generate filename for reference (even though we're not saving files in production)\n                const reportSuffix = reportType === \"custom\" ? `${startDate}_to_${endDate}` : `${reportType}_${startDate}_to_${endDate}`;\n                const filename = `${platform.name}_${reportSuffix}.csv`;\n                // Simulate local storage info for UI\n                if (platformData && platformData.length > 0) {\n                    const csvContent = convertToCSV(platformData);\n                    localStorage[platform.name] = {\n                        filename: filename,\n                        size: csvContent.length // Use string length as size approximation\n                    };\n                }\n                results.push({\n                    platform: platform.name,\n                    success: true,\n                    rowCount: rowCount,\n                    dateRange: dateRangeActual,\n                    sampleData: platformData && platformData.length > 0 ? [\n                        platformData[0]\n                    ] : []\n                });\n                data[platform.name] = platformData;\n                console.log(`${platform.name}: ${rowCount} rows retrieved`);\n            } catch (platformError) {\n                console.error(`Error processing ${platform.name}:`, platformError);\n                results.push({\n                    platform: platform.name,\n                    success: false,\n                    rowCount: 0,\n                    dateRange: {\n                        min: null,\n                        max: null\n                    },\n                    error: platformError.message\n                });\n                data[platform.name] = null;\n            }\n        }\n        // Summary\n        const totalRows = results.reduce((sum, result)=>sum + result.rowCount, 0);\n        const successCount = results.filter((r)=>r.success).length;\n        console.log(`Data retrieval complete: ${successCount}/${results.length} platforms successful, ${totalRows} total rows`);\n        res.status(200).json({\n            success: successCount === results.length,\n            results,\n            data,\n            localStorage,\n            summary: {\n                totalRows,\n                successfulPlatforms: successCount,\n                totalPlatforms: results.length,\n                dateRange: {\n                    startDate,\n                    endDate\n                },\n                reportType\n            }\n        });\n    } catch (error) {\n        console.error(\"Data retrieval error:\", error);\n        res.status(500).json({\n            error: \"Data retrieval failed\",\n            details: error.message\n        });\n    }\n}\nfunction convertToCSV(data) {\n    if (!data || data.length === 0) return \"\";\n    const headers = Object.keys(data[0]);\n    // Properly escape headers that contain commas, quotes, or newlines\n    const escapedHeaders = headers.map((header)=>{\n        if (header.includes(\",\") || header.includes('\"') || header.includes(\"\\n\")) {\n            return `\"${header.replace(/\"/g, '\"\"')}\"`;\n        }\n        return header;\n    });\n    const csvRows = [\n        escapedHeaders.join(\",\")\n    ];\n    for (const row of data){\n        const values = headers.map((header)=>{\n            const value = row[header];\n            // Handle null/undefined values\n            if (value === null || value === undefined) return \"\";\n            // Escape commas and quotes in values\n            const stringValue = String(value);\n            if (stringValue.includes(\",\") || stringValue.includes('\"') || stringValue.includes(\"\\n\")) {\n                return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\n            }\n            return stringValue;\n        });\n        csvRows.push(values.join(\",\"));\n    }\n    return csvRows.join(\"\\n\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPRCxRQUFRQyxJQUFJLENBQUM7QUFDdEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tb2ktdXBsb2FkLXN5c3RlbS8uL3BhZ2VzL2FwaS9yZXRyaWV2ZS1kYXRhLmpzPzFlZDgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tICcuLi8uLi9saWIvc3VwYWJhc2UnXG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgcmVwb3J0VHlwZSB9ID0gcmVxLmJvZHlcblxuICAgIGlmICghc3RhcnREYXRlIHx8ICFlbmREYXRlKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ1N0YXJ0IGRhdGUgYW5kIGVuZCBkYXRlIGFyZSByZXF1aXJlZCcgfSlcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBkYXRlIGZvcm1hdFxuICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoc3RhcnREYXRlKVxuICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpXG4gICAgXG4gICAgaWYgKGlzTmFOKHN0YXJ0LmdldFRpbWUoKSkgfHwgaXNOYU4oZW5kLmdldFRpbWUoKSkpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnSW52YWxpZCBkYXRlIGZvcm1hdCcgfSlcbiAgICB9XG5cbiAgICBpZiAoc3RhcnQgPiBlbmQpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnU3RhcnQgZGF0ZSBtdXN0IGJlIGJlZm9yZSBlbmQgZGF0ZScgfSlcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhgUmV0cmlldmluZyBkYXRhIGZyb20gJHtzdGFydERhdGV9IHRvICR7ZW5kRGF0ZX0gZm9yICR7cmVwb3J0VHlwZX0gcmVwb3J0YClcblxuICAgIGNvbnN0IHJlc3VsdHMgPSBbXVxuICAgIGNvbnN0IGRhdGEgPSB7fVxuICAgIGNvbnN0IGxvY2FsU3RvcmFnZSA9IHt9XG5cbiAgICAvLyBQbGF0Zm9ybSBjb25maWd1cmF0aW9uc1xuICAgIGNvbnN0IHBsYXRmb3JtcyA9IFtcbiAgICAgIHsgbmFtZTogJ21ldGEnLCB0YWJsZTogJ21ldGFfaW1wb3J0X2RhdGEnLCBkYXRlQ29sdW1uOiAnRGF5JyB9LFxuICAgICAgeyBuYW1lOiAnZ29vZ2xlJywgdGFibGU6ICdnb29nbGVfaW1wb3J0X2RhdGEnLCBkYXRlQ29sdW1uOiAnRGF5JyB9LFxuICAgICAgeyBuYW1lOiAnc2hvcGlmeScsIHRhYmxlOiAnc2hvcGlmeV9pbXBvcnRfZGF0YScsIGRhdGVDb2x1bW46ICdEYXknIH1cbiAgICBdXG5cbiAgICBmb3IgKGNvbnN0IHBsYXRmb3JtIG9mIHBsYXRmb3Jtcykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc29sZS5sb2coYFF1ZXJ5aW5nICR7cGxhdGZvcm0udGFibGV9IGZvciBkYXRlIHJhbmdlICR7c3RhcnREYXRlfSB0byAke2VuZERhdGV9YClcblxuICAgICAgICAvLyBRdWVyeSBTdXBhYmFzZSBmb3IgdGhlIHBsYXRmb3JtIGRhdGFcbiAgICAgICAgY29uc3QgeyBkYXRhOiBwbGF0Zm9ybURhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgIC5mcm9tKHBsYXRmb3JtLnRhYmxlKVxuICAgICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAgIC5ndGUocGxhdGZvcm0uZGF0ZUNvbHVtbiwgc3RhcnREYXRlKVxuICAgICAgICAgIC5sdGUocGxhdGZvcm0uZGF0ZUNvbHVtbiwgZW5kRGF0ZSlcbiAgICAgICAgICAub3JkZXIocGxhdGZvcm0uZGF0ZUNvbHVtbiwgeyBhc2NlbmRpbmc6IHRydWUgfSlcblxuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBxdWVyeWluZyAke3BsYXRmb3JtLnRhYmxlfTpgLCBlcnJvcilcbiAgICAgICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgcGxhdGZvcm06IHBsYXRmb3JtLm5hbWUsXG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIHJvd0NvdW50OiAwLFxuICAgICAgICAgICAgZGF0ZVJhbmdlOiB7IG1pbjogbnVsbCwgbWF4OiBudWxsIH0sXG4gICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxuICAgICAgICAgIH0pXG4gICAgICAgICAgZGF0YVtwbGF0Zm9ybS5uYW1lXSA9IG51bGxcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgcm93Q291bnQgPSBwbGF0Zm9ybURhdGEgPyBwbGF0Zm9ybURhdGEubGVuZ3RoIDogMFxuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGRhdGUgcmFuZ2UgZnJvbSBhY3R1YWwgZGF0YVxuICAgICAgICBsZXQgZGF0ZVJhbmdlQWN0dWFsID0geyBtaW46IG51bGwsIG1heDogbnVsbCB9XG4gICAgICAgIGlmIChyb3dDb3VudCA+IDApIHtcbiAgICAgICAgICBjb25zdCBkYXRlcyA9IHBsYXRmb3JtRGF0YS5tYXAocm93ID0+IHJvd1twbGF0Zm9ybS5kYXRlQ29sdW1uXSkuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgICAgaWYgKGRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gZGF0ZXMuc29ydCgpXG4gICAgICAgICAgICBkYXRlUmFuZ2VBY3R1YWwgPSB7XG4gICAgICAgICAgICAgIG1pbjogc29ydGVkRGF0ZXNbMF0sXG4gICAgICAgICAgICAgIG1heDogc29ydGVkRGF0ZXNbc29ydGVkRGF0ZXMubGVuZ3RoIC0gMV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZW5lcmF0ZSBmaWxlbmFtZSBmb3IgcmVmZXJlbmNlIChldmVuIHRob3VnaCB3ZSdyZSBub3Qgc2F2aW5nIGZpbGVzIGluIHByb2R1Y3Rpb24pXG4gICAgICAgIGNvbnN0IHJlcG9ydFN1ZmZpeCA9IHJlcG9ydFR5cGUgPT09ICdjdXN0b20nIFxuICAgICAgICAgID8gYCR7c3RhcnREYXRlfV90b18ke2VuZERhdGV9YCBcbiAgICAgICAgICA6IGAke3JlcG9ydFR5cGV9XyR7c3RhcnREYXRlfV90b18ke2VuZERhdGV9YFxuICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGAke3BsYXRmb3JtLm5hbWV9XyR7cmVwb3J0U3VmZml4fS5jc3ZgXG5cbiAgICAgICAgLy8gU2ltdWxhdGUgbG9jYWwgc3RvcmFnZSBpbmZvIGZvciBVSVxuICAgICAgICBpZiAocGxhdGZvcm1EYXRhICYmIHBsYXRmb3JtRGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgY3N2Q29udGVudCA9IGNvbnZlcnRUb0NTVihwbGF0Zm9ybURhdGEpXG4gICAgICAgICAgbG9jYWxTdG9yYWdlW3BsYXRmb3JtLm5hbWVdID0ge1xuICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGVuYW1lLFxuICAgICAgICAgICAgc2l6ZTogY3N2Q29udGVudC5sZW5ndGggLy8gVXNlIHN0cmluZyBsZW5ndGggYXMgc2l6ZSBhcHByb3hpbWF0aW9uXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmVzdWx0cy5wdXNoKHtcbiAgICAgICAgICBwbGF0Zm9ybTogcGxhdGZvcm0ubmFtZSxcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIHJvd0NvdW50OiByb3dDb3VudCxcbiAgICAgICAgICBkYXRlUmFuZ2U6IGRhdGVSYW5nZUFjdHVhbCxcbiAgICAgICAgICBzYW1wbGVEYXRhOiBwbGF0Zm9ybURhdGEgJiYgcGxhdGZvcm1EYXRhLmxlbmd0aCA+IDAgPyBbcGxhdGZvcm1EYXRhWzBdXSA6IFtdXG4gICAgICAgIH0pXG5cbiAgICAgICAgZGF0YVtwbGF0Zm9ybS5uYW1lXSA9IHBsYXRmb3JtRGF0YVxuXG4gICAgICAgIGNvbnNvbGUubG9nKGAke3BsYXRmb3JtLm5hbWV9OiAke3Jvd0NvdW50fSByb3dzIHJldHJpZXZlZGApXG5cbiAgICAgIH0gY2F0Y2ggKHBsYXRmb3JtRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcHJvY2Vzc2luZyAke3BsYXRmb3JtLm5hbWV9OmAsIHBsYXRmb3JtRXJyb3IpXG4gICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgcGxhdGZvcm06IHBsYXRmb3JtLm5hbWUsXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgcm93Q291bnQ6IDAsXG4gICAgICAgICAgZGF0ZVJhbmdlOiB7IG1pbjogbnVsbCwgbWF4OiBudWxsIH0sXG4gICAgICAgICAgZXJyb3I6IHBsYXRmb3JtRXJyb3IubWVzc2FnZVxuICAgICAgICB9KVxuICAgICAgICBkYXRhW3BsYXRmb3JtLm5hbWVdID0gbnVsbFxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFN1bW1hcnlcbiAgICBjb25zdCB0b3RhbFJvd3MgPSByZXN1bHRzLnJlZHVjZSgoc3VtLCByZXN1bHQpID0+IHN1bSArIHJlc3VsdC5yb3dDb3VudCwgMClcbiAgICBjb25zdCBzdWNjZXNzQ291bnQgPSByZXN1bHRzLmZpbHRlcihyID0+IHIuc3VjY2VzcykubGVuZ3RoXG5cbiAgICBjb25zb2xlLmxvZyhgRGF0YSByZXRyaWV2YWwgY29tcGxldGU6ICR7c3VjY2Vzc0NvdW50fS8ke3Jlc3VsdHMubGVuZ3RofSBwbGF0Zm9ybXMgc3VjY2Vzc2Z1bCwgJHt0b3RhbFJvd3N9IHRvdGFsIHJvd3NgKVxuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgc3VjY2Vzczogc3VjY2Vzc0NvdW50ID09PSByZXN1bHRzLmxlbmd0aCxcbiAgICAgIHJlc3VsdHMsXG4gICAgICBkYXRhLFxuICAgICAgbG9jYWxTdG9yYWdlLFxuICAgICAgc3VtbWFyeToge1xuICAgICAgICB0b3RhbFJvd3MsXG4gICAgICAgIHN1Y2Nlc3NmdWxQbGF0Zm9ybXM6IHN1Y2Nlc3NDb3VudCxcbiAgICAgICAgdG90YWxQbGF0Zm9ybXM6IHJlc3VsdHMubGVuZ3RoLFxuICAgICAgICBkYXRlUmFuZ2U6IHsgc3RhcnREYXRlLCBlbmREYXRlIH0sXG4gICAgICAgIHJlcG9ydFR5cGVcbiAgICAgIH1cbiAgICB9KVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRGF0YSByZXRyaWV2YWwgZXJyb3I6JywgZXJyb3IpXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcbiAgICAgIGVycm9yOiAnRGF0YSByZXRyaWV2YWwgZmFpbGVkJyxcbiAgICAgIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgXG4gICAgfSlcbiAgfVxufVxuXG5mdW5jdGlvbiBjb252ZXJ0VG9DU1YoZGF0YSkge1xuICBpZiAoIWRhdGEgfHwgZGF0YS5sZW5ndGggPT09IDApIHJldHVybiAnJ1xuXG4gIGNvbnN0IGhlYWRlcnMgPSBPYmplY3Qua2V5cyhkYXRhWzBdKVxuICBcbiAgLy8gUHJvcGVybHkgZXNjYXBlIGhlYWRlcnMgdGhhdCBjb250YWluIGNvbW1hcywgcXVvdGVzLCBvciBuZXdsaW5lc1xuICBjb25zdCBlc2NhcGVkSGVhZGVycyA9IGhlYWRlcnMubWFwKGhlYWRlciA9PiB7XG4gICAgaWYgKGhlYWRlci5pbmNsdWRlcygnLCcpIHx8IGhlYWRlci5pbmNsdWRlcygnXCInKSB8fCBoZWFkZXIuaW5jbHVkZXMoJ1xcbicpKSB7XG4gICAgICByZXR1cm4gYFwiJHtoZWFkZXIucmVwbGFjZSgvXCIvZywgJ1wiXCInKX1cImBcbiAgICB9XG4gICAgcmV0dXJuIGhlYWRlclxuICB9KVxuICBcbiAgY29uc3QgY3N2Um93cyA9IFtlc2NhcGVkSGVhZGVycy5qb2luKCcsJyldXG5cbiAgZm9yIChjb25zdCByb3cgb2YgZGF0YSkge1xuICAgIGNvbnN0IHZhbHVlcyA9IGhlYWRlcnMubWFwKGhlYWRlciA9PiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJvd1toZWFkZXJdXG4gICAgICAvLyBIYW5kbGUgbnVsbC91bmRlZmluZWQgdmFsdWVzXG4gICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuICcnXG4gICAgICAvLyBFc2NhcGUgY29tbWFzIGFuZCBxdW90ZXMgaW4gdmFsdWVzXG4gICAgICBjb25zdCBzdHJpbmdWYWx1ZSA9IFN0cmluZyh2YWx1ZSlcbiAgICAgIGlmIChzdHJpbmdWYWx1ZS5pbmNsdWRlcygnLCcpIHx8IHN0cmluZ1ZhbHVlLmluY2x1ZGVzKCdcIicpIHx8IHN0cmluZ1ZhbHVlLmluY2x1ZGVzKCdcXG4nKSkge1xuICAgICAgICByZXR1cm4gYFwiJHtzdHJpbmdWYWx1ZS5yZXBsYWNlKC9cIi9nLCAnXCJcIicpfVwiYFxuICAgICAgfVxuICAgICAgcmV0dXJuIHN0cmluZ1ZhbHVlXG4gICAgfSlcbiAgICBjc3ZSb3dzLnB1c2godmFsdWVzLmpvaW4oJywnKSlcbiAgfVxuXG4gIHJldHVybiBjc3ZSb3dzLmpvaW4oJ1xcbicpXG59Il0sIm5hbWVzIjpbInN1cGFiYXNlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJyZXBvcnRUeXBlIiwiYm9keSIsInN0YXJ0IiwiRGF0ZSIsImVuZCIsImlzTmFOIiwiZ2V0VGltZSIsImNvbnNvbGUiLCJsb2ciLCJyZXN1bHRzIiwiZGF0YSIsImxvY2FsU3RvcmFnZSIsInBsYXRmb3JtcyIsIm5hbWUiLCJ0YWJsZSIsImRhdGVDb2x1bW4iLCJwbGF0Zm9ybSIsInBsYXRmb3JtRGF0YSIsImZyb20iLCJzZWxlY3QiLCJndGUiLCJsdGUiLCJvcmRlciIsImFzY2VuZGluZyIsInB1c2giLCJzdWNjZXNzIiwicm93Q291bnQiLCJkYXRlUmFuZ2UiLCJtaW4iLCJtYXgiLCJtZXNzYWdlIiwibGVuZ3RoIiwiZGF0ZVJhbmdlQWN0dWFsIiwiZGF0ZXMiLCJtYXAiLCJyb3ciLCJmaWx0ZXIiLCJCb29sZWFuIiwic29ydGVkRGF0ZXMiLCJzb3J0IiwicmVwb3J0U3VmZml4IiwiZmlsZW5hbWUiLCJjc3ZDb250ZW50IiwiY29udmVydFRvQ1NWIiwic2l6ZSIsInNhbXBsZURhdGEiLCJwbGF0Zm9ybUVycm9yIiwidG90YWxSb3dzIiwicmVkdWNlIiwic3VtIiwicmVzdWx0Iiwic3VjY2Vzc0NvdW50IiwiciIsInN1bW1hcnkiLCJzdWNjZXNzZnVsUGxhdGZvcm1zIiwidG90YWxQbGF0Zm9ybXMiLCJkZXRhaWxzIiwiaGVhZGVycyIsIk9iamVjdCIsImtleXMiLCJlc2NhcGVkSGVhZGVycyIsImhlYWRlciIsImluY2x1ZGVzIiwicmVwbGFjZSIsImNzdlJvd3MiLCJqb2luIiwidmFsdWVzIiwidmFsdWUiLCJ1bmRlZmluZWQiLCJzdHJpbmdWYWx1ZSIsIlN0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/retrieve-data.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fretrieve-data&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fretrieve-data.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();
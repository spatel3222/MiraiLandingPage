name: Deploy to Production

on:
  push:
    branches: [ main ]

jobs:
  deploy-production:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Validate HTML files
      run: |
        echo "üîç Validating HTML files..."
        find . -name "*.html" -not -path "./node_modules/*" -not -path "./.next/*" | while read file; do
          echo "‚úÖ Checking: $file"
          # Basic HTML structure check
          if ! grep -q "<html" "$file" && ! grep -q "<!DOCTYPE" "$file"; then
            echo "‚ö†Ô∏è  Warning: $file may not be a complete HTML document"
          fi
        done
        
    - name: Check critical files exist
      run: |
        echo "üîç Checking critical files..."
        test -f "index.html" && echo "‚úÖ index.html exists" || echo "‚ùå index.html missing"
        test -f "CNAME" && echo "‚úÖ CNAME exists" || echo "‚ùå CNAME missing"
        
    - name: Deploy to GitHub Pages (production)
      uses: peaceiris/actions-gh-pages@v4
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./
        cname: crtx.in
        
    - name: Production deployment success notification
      run: |
        echo "üöÄ Production deployment completed!"
        echo "üåê Site available at: https://crtx.in"